var cov_26ukn40385=function(){var path="D:\\Hobby\\eleaving\\backend\\AuthService\\src\\service\\AuthService.js";var hash="66cdc478b6c4f2fad8a26223c1e171512312d5b9";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\Hobby\\eleaving\\backend\\AuthService\\src\\service\\AuthService.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:30}},"1":{start:{line:3,column:11},end:{line:3,column:26}},"2":{start:{line:5,column:19},end:{line:5,column:35}},"3":{start:{line:6,column:19},end:{line:6,column:25}},"4":{start:{line:9,column:14},end:{line:15,column:2}},"5":{start:{line:17,column:0},end:{line:17,column:80}},"6":{start:{line:18,column:0},end:{line:18,column:18}},"7":{start:{line:20,column:0},end:{line:39,column:1}},"8":{start:{line:21,column:19},end:{line:21,column:36}},"9":{start:{line:22,column:19},end:{line:22,column:36}},"10":{start:{line:24,column:4},end:{line:38,column:5}},"11":{start:{line:25,column:8},end:{line:34,column:11}},"12":{start:{line:26,column:12},end:{line:26,column:33}},"13":{start:{line:27,column:12},end:{line:32,column:13}},"14":{start:{line:28,column:16},end:{line:28,column:45}},"15":{start:{line:29,column:16},end:{line:29,column:166}},"16":{start:{line:31,column:16},end:{line:31,column:86}},"17":{start:{line:33,column:12},end:{line:33,column:22}},"18":{start:{line:36,column:8},end:{line:36,column:76}},"19":{start:{line:37,column:8},end:{line:37,column:18}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:20,column:16},end:{line:20,column:17}},loc:{start:{line:20,column:30},end:{line:39,column:1}},line:20},"1":{name:"(anonymous_1)",decl:{start:{line:25,column:106},end:{line:25,column:107}},loc:{start:{line:25,column:138},end:{line:34,column:9}},line:25}},branchMap:{"0":{loc:{start:{line:24,column:4},end:{line:38,column:5}},type:"if",locations:[{start:{line:24,column:4},end:{line:38,column:5}},{start:{line:24,column:4},end:{line:38,column:5}}],line:24},"1":{loc:{start:{line:24,column:8},end:{line:24,column:28}},type:"binary-expr",locations:[{start:{line:24,column:8},end:{line:24,column:16}},{start:{line:24,column:20},end:{line:24,column:28}}],line:24},"2":{loc:{start:{line:27,column:12},end:{line:32,column:13}},type:"if",locations:[{start:{line:27,column:12},end:{line:32,column:13}},{start:{line:27,column:12},end:{line:32,column:13}}],line:27}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"66cdc478b6c4f2fad8a26223c1e171512312d5b9"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();const MySQL=(cov_26ukn40385.s[0]++,require('mysql'));var sha1=(cov_26ukn40385.s[1]++,require('sha1'));const HOST_MYSQL=(cov_26ukn40385.s[2]++,'35.240.188.199');const PORT_MYSQL=(cov_26ukn40385.s[3]++,'3307');// Connect Database
var connect=(cov_26ukn40385.s[4]++,MySQL.createConnection({host:HOST_MYSQL,port:PORT_MYSQL,user:'root',password:'soaeleaving',database:'authdatabase'}));cov_26ukn40385.s[5]++;console.log(`[Auth Service] Connected to Mysql -> ${HOST_MYSQL}:${PORT_MYSQL}`);cov_26ukn40385.s[6]++;connect.connect();cov_26ukn40385.s[7]++;exports.login=(req,res)=>{cov_26ukn40385.f[0]++;var username=(cov_26ukn40385.s[8]++,req.body.username);var password=(cov_26ukn40385.s[9]++,req.body.password);cov_26ukn40385.s[10]++;if((cov_26ukn40385.b[1][0]++,username)&&(cov_26ukn40385.b[1][1]++,password)){cov_26ukn40385.b[0][0]++;cov_26ukn40385.s[11]++;connect.query('SELECT * FROM accounts WHERE username = ? AND password = ?',[username,password],function(err,results,fields){cov_26ukn40385.f[1]++;cov_26ukn40385.s[12]++;console.log(results);cov_26ukn40385.s[13]++;if(results.length){cov_26ukn40385.b[2][0]++;cov_26ukn40385.s[14]++;console.log("Login success");cov_26ukn40385.s[15]++;res.status(200).send({"account_id":results[0].account_id,"username":results[0].username,"account_type":results[0].account_type,"isLogin":true});}else{cov_26ukn40385.b[2][1]++;cov_26ukn40385.s[16]++;res.status(400).send({"isLogin":'ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง'});}cov_26ukn40385.s[17]++;res.end();});}else{cov_26ukn40385.b[0][1]++;cov_26ukn40385.s[18]++;res.status(400).send({"isLogin":'กรุณากรอกชื่อผู้ใช้และรหัสผ่าน'});cov_26ukn40385.s[19]++;res.end();}};